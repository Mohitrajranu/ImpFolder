SELECT * FROM (SELECT DISTINCT SI.subs_type,  SI.MSISDN , SI.REGION_CODE, SI.OFFER_ID,  SI.PLAN_ID,  SI.AUTO_RENEW ,SI.REQ_PLAN_ID,   SI.REQ_NEXT_PLAN_ID, SI.CUST_SERVICE_ID,  SI.SERVICE_TYPE,   SI.SERVICE_ID,      SI.BEARER_ID,  SI.SERVICE_NODE, SI.CONTENT_ID,   SI.CATEGORY,    SI.TRXN_ID,   SI.PARAM1,   SI.PARAM2,   SI.PARAM3, SI.PARAM4,   SI.PARAM5, SI.CUST_STATUS,     SI.LANGUAGE_ID,   SI.CHARGING_AMOUNT,   SI.LINKED_SERVICE_ID,   SI.LINKED_SERVICE_TYPE,   SI.OPERATION,  SI.CRM_ID,  SI.CALLED_PARTY, SI.SUBSCRIPTION_ID , SI.PRODUCT_ORDER_ID,  SI.MODE_OF_PAYMENT , SM.SERVICE_GROUP ,ROWNUM rn FROM  T_SUB_SERVICE_INFO SI, T_D_CNF_SERVICE_MASTER SM WHERE  SI.AUTO_RENEW='Y'  AND SI.CUST_STATUS = 'A' AND SI.RENEWAL_DATE < trunc(sysdate+1) AND SI.SERVICE_ID = SM.SERVICE_ID AND SI.SERVICE_TYPE = SM.SERVICE_TYPE
